<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Parking Violations Dashboard</title>
</head>
<body>
<h2>Record a New Violation</h2>
<input type="text" id="plate" placeholder="Enter vehicle number">
<button onclick="recordViolation()">Submit</button>

<h2>Vehicle Logs</h2>
<ul id="logs"></ul>

<h2>Cases</h2>
<ul id="cases"></ul>

<script>
async function recordViolation() {
    const plate = document.getElementById("plate").value;
    const response = await fetch("http://127.0.0.1:8000/api/new_violation", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({number: plate})
    });
    const data = await response.json();
    alert(data.message);
    getLogs();
}

async function getLogs() {
    const logsResp = await fetch("http://127.0.0.1:8000/api/get_vehicle_logs");
    const logs = await logsResp.json();
    const logsUl = document.getElementById("logs");
    logsUl.innerHTML = "";
    logs.forEach(log => {
        const li = document.createElement("li");
        li.textContent = `${log.timestamp} - ${log.plate} - ${log.violation}`;
        logsUl.appendChild(li);
    });

    const casesResp = await fetch("http://127.0.0.1:8000/api/get_cases");
    const cases = await casesResp.json();
    const casesUl = document.getElementById("cases");
    casesUl.innerHTML = "";
    cases.forEach(c => {
        const li = document.createElement("li");
        li.textContent = JSON.stringify(c);
        casesUl.appendChild(li);
    });
}

// Auto-refresh every 5 seconds
setInterval(getLogs, 5000);
getLogs();
</script>
</body>
</html>
